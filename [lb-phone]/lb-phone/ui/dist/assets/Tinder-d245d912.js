import{ak as De,ap as O,r as h,j as n,a as e,bZ as Re,h as ke,E as de,p as L,N as ye,m as Se,L as m,d as U,a3 as ee,cw as xe,aU as Le,u as j,P as Y,F as W,I as _e,f as Oe,cx as oe,bM as re,C as B,b as ie,aw as Te,q as Z,s as G,H as Ve,_ as Me,cm as Fe,a7 as be,a2 as ue,ab as Ue,ac as Ee,aP as $e,cd as He,K as We,a9 as Be,w as Ge,an as Ye,ba as he,bd as ze}from"./index-594e1857.js";import{T as Ae}from"./Textarea-251c47d2.js";var Ke=function(s){return new Promise(function(i){setTimeout(i,s)})};const pe=De(Ke),x={snapBackDuration:300,maxTilt:5,bouncePower:.1,swipeThreshold:100},je=t=>{const s=window.getComputedStyle(t),i=s.getPropertyValue("width"),g=Number(i.split("px")[0]),E=s.getPropertyValue("height"),I=Number(E.split("px")[0]);return{x:g,y:I}},Pe=(t,s)=>Math.sqrt(Math.pow(t,2)+Math.pow(s,2)),qe=(t,s=1)=>{const i=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:t.x*s/i,y:t.y*s/i}},me=async(t,s,i=!1)=>{const g=ce(t),E=je(document.body),I=Pe(E.x,E.y),o=Pe(s.x,s.y),p=I/o,c=I/o,v=ve(s.x*c+g.x,-s.y*c+g.y);let u="";const l=200;i?t.style.transition="ease "+p+"s":t.style.transition="ease-out "+p+"s",J(t)===0?u=X((Math.random()-.5)*l):J(t)>0?u=X(Math.random()*l/2+J(t)):u=X((Math.random()-1)*l/2+J(t)),t.style.transform=v+u,await pe(p*1e3)},we=async t=>{t.style.transition=x.snapBackDuration+"ms";const s=ce(t),i=ve(s.x*-x.bouncePower,s.y*-x.bouncePower),g=X(J(t)*-x.bouncePower);t.style.transform=i+g,await pe(x.snapBackDuration*.75),t.style.transform="none",await pe(x.snapBackDuration),t.style.transition="10ms"},Ie=t=>{if(Math.abs(t.x)>Math.abs(t.y)){if(t.x>x.swipeThreshold)return"right";if(t.x<-x.swipeThreshold)return"left"}else{if(t.y>x.swipeThreshold)return"up";if(t.y<-x.swipeThreshold)return"down"}return"none"},Ce=(t,s)=>{const i=s.x-t.x,g=t.y-s.y,E=(s.time-t.time)/1e3;return{x:i/E,y:g/E}},ve=(t,s)=>"translate("+t+"px)",X=t=>"rotate("+t+"deg)",ce=t=>{const s=window.getComputedStyle(t),i=new DOMMatrix(s.transform);return{x:i.m41,y:-i.m42}},J=t=>{const s=window.getComputedStyle(t),i=new DOMMatrix(s.transform);return-Math.asin(i.m21)/(2*Math.PI)*360},Je=(t,s,i,g)=>{const E={x:t.x+i.x,y:t.y+i.y},I={x:E.x,y:E.y,time:new Date().getTime()},o=ve(E.x),p=Ce(g,I).x/1e3,c=X(p*x.maxTilt);return s.style.transform=o+c,I},ge=t=>{const s=t.targetTouches[0];return{x:s.clientX,y:s.clientY}},fe=t=>({x:t.clientX,y:t.clientY}),Xe=O.forwardRef(({flickOnSwipe:t=!0,children:s,onSwipe:i,onCardLeftScreen:g,className:E,preventSwipe:I=[],swipeRequirementType:o="velocity",swipeThreshold:p=x.swipeThreshold,onSwipeRequirementFulfilled:c,onSwipeRequirementUnfulfilled:v},u)=>{x.swipeThreshold=p;const l=O.useRef(!1),f=O.useRef();O.useImperativeHandle(u,()=>({async swipe(T="right"){i&&i(T);const y=1e3,A=(Math.random()-.5)*100;T==="right"?await me(f.current,{x:y,y:A},!0):T==="left"&&await me(f.current,{x:-y,y:A},!0),f.current.style.display="none",g&&g(T)},async restoreCard(){f.current.style.display="block",await we(f.current)}}));const r=O.useCallback(async(T,y)=>{if(l.current)return;l.current=!0;const A=ce(T),d=Ie(o==="velocity"?y:A);if(d!=="none"&&(i&&i(d),t&&!I.includes(d))){const P=o==="velocity"?y:qe(A,600);await me(T,P),T.style.display="none",g&&g(d);return}we(T)},[l,t,i,g,I,o]),w=O.useCallback(()=>{l.current=!1},[l]);return O.useLayoutEffect(()=>{let T={x:null,y:null},y={x:0,y:0},A={x:0,y:0,time:new Date().getTime()},d=!1,P="none";f.current.addEventListener("touchstart",b=>{b.preventDefault(),w(),T={x:-ge(b).x,y:-ge(b).y}}),f.current.addEventListener("mousedown",b=>{b.preventDefault(),d=!0,w(),T={x:-fe(b).x,y:-fe(b).y}});const R=b=>{if(c||v){const a=Ie(o==="velocity"?y:ce(f.current));a!==P&&(P=a,P==="none"?v&&v():c&&c(a))}const M=Je(b,f.current,T,A);y=Ce(A,M),A=M};f.current.addEventListener("touchmove",b=>{b.preventDefault(),R(ge(b))}),f.current.addEventListener("mousemove",b=>{b.preventDefault(),d&&R(fe(b))}),f.current.addEventListener("touchend",b=>{b.preventDefault(),r(f.current,y)}),f.current.addEventListener("mouseup",b=>{d&&(b.preventDefault(),d=!1,r(f.current,y))}),f.current.addEventListener("mouseleave",b=>{d&&(b.preventDefault(),d=!1,r(f.current,y))})},[]),O.createElement("div",{ref:f,className:E},s)});function Ne(){const{View:t}=h.useContext(z),[s,i]=t;return n("div",{className:"home-header",children:[e(Re,{onClick:()=>i("profile")}),e("img",{className:"logo",src:"./assets/img/icons/tinder/logo.svg",onClick:()=>i("home")}),e(ke,{onClick:()=>i("messageList")})]})}const $={account:{name:"James",bio:"I'm a cool guy",dob:9624888e5,photos:["https://r2.fivemanage.com/images/GRBUI6C4orbD.webp","https://r2.fivemanage.com/images/98avzSwlgzsg.webp","https://r2.fivemanage.com/images/rafgjPwSYnn2.png"],showMen:!1,showWomen:!0,isMale:!0,active:!0},accounts:[{number:"1",dob:9653888e5,name:"Jessica",bio:"Swipe right if you like dogs",photos:["https://r2.fivemanage.com/images/oRKcdeTA8oBy.png"],isMale:!1,matched:!0},{number:"2",dob:9653888e5,name:"Klara",bio:"Member of Lost MC, looking for a good time",photos:["https://r2.fivemanage.com/images/787FMzhn5xD5.png","https://r2.fivemanage.com/images/ZsmnyJOA2rc5.png"],isMale:!1,liked:!0},{number:"3",dob:9653888e5,name:"Steph",bio:"Evening strolls are my thing",photos:["https://r2.fivemanage.com/images/7zj3Xgy6FsXK.png"],matched:!0,isMale:!1,lastMessage:"I'm perfect, you look good!"}],messages:{3:[{sender:"1",content:"Im perfect, you look good!",timestamp:Date.now()-1e3*60*60*24*1},{sender:"1234567890",content:"I'm good, how about you?",timestamp:Date.now()-1e3*60*60*24*2},{sender:"1",content:"Hey, how are you?",timestamp:Date.now()-1e3*60*60*24*3}]}};function Ze(){const{View:t,User:s,Account:i}=h.useContext(z),[g,E]=t,[I,o]=s,[p,c]=i,[v,u]=h.useState([]),[l,f]=h.useState(0),[r,w]=h.useState(),T=h.useRef(l),y=h.useRef(0),[A,d]=h.useState([]),[P,R]=h.useState(0),[b,M]=h.useState(!1),[a,S]=h.useState(null);let[D,V]=h.useState("");h.useEffect(()=>{de("Tinder")&&L("Tinder",{action:"getFeed",page:0},$.accounts.filter(N=>!N.matched)).then(N=>{N&&N.length>0?(u(N),f(N.length-1),y.current=N.length,d(Array(N.length).fill(0).map(C=>O.createRef()))):M(!0)})},[]);const H=N=>{f(N),T.current=N},K=l<v.length-1,te=l>=0,se=(N,C,_)=>{w(N),H(_-1),F(),N==="right"?L("Tinder",{action:"swipe",like:!0,number:C.number},$.accounts.find(ae=>ae.liked&&ae.number==C.number)).then(ae=>{ae&&S(C)}):N==="left"&&L("Tinder",{action:"swipe",like:!1,number:C.number})},ne=(N,C)=>{T.current>=C&&A[C].current.restoreCard()},q=async N=>{te&&l<v.length&&(await A[l].current.swipe(N),F())},k=async()=>{var C,_;if(!K)return;const N=l+1;H(N),await((_=(C=A[N])==null?void 0:C.current)==null?void 0:_.restoreCard())},F=()=>{if(y.current>1){y.current=y.current-1;return}L("Tinder",{action:"getFeed",page:P+1}).then(N=>{if(N)if(N&&N.length>0){R(P+1);let C=N.length+v.length;u(_=>(_=[..._,...N],_)),y.current=N.length,f(C-1),d(Array(C).fill(0).map(_=>O.createRef()))}else M(!0)})};return n("div",{className:`home-wrapper slide ${g=="profile"?"left":"right"}`,children:[e(Ne,{}),e(ye,{children:a&&n(Se.div,{initial:{opacity:0,scale:.1},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.1},transition:{duration:.3,ease:"easeInOut"},className:"match",style:{backgroundImage:`url(${a.photos[0]})`},children:[e("img",{className:"match-image",src:"./assets/img/icons/tinder/match.png"}),n("div",{className:"likes-too",children:[a.name," ",m("APPS.TINDER.LIKES_YOU_TOO").toLowerCase()]}),n("div",{className:"input",children:[e(U,{type:"text",placeholder:m("APPS.TINDER.SAY_SOMETHING_NICE"),onChange:N=>V(N.target.value)}),e("div",{className:"send",onClick:()=>{L("Tinder",{action:"sendMessage",data:{recipient:a.number,content:D}},!0).then(N=>{N&&(o(a),E("message"))})},children:m("APPS.TINDER.SEND")})]}),e("div",{className:"keep-swiping",onClick:()=>S(null),children:m("APPS.TINDER.KEEP_SWIPING")})]})}),n("div",{className:"home-body",children:[n("div",{className:"cards",children:[b&&e("div",{className:"card no-more",children:e("div",{children:m("APPS.TINDER.NO_MORE")})}),!p.active&&e("div",{className:"card no-more",children:e("div",{children:m("APPS.TINDER.HIDDEN_PROFILE")})}),p.active&&v.map((N,C)=>e(Xe,{ref:A[C],className:"swipe",onSwipe:_=>se(_,N,C),onCardLeftScreen:()=>ne(N,C),children:e(Qe,{user:N})},C))]}),n("div",{className:"actions",children:[e("div",{className:"button",onClick:()=>q("left"),children:e(ee,{style:{color:"#F24C65"}})}),e("div",{className:`button small ${K?"":"disabled"}`,onClick:()=>k(),children:e(xe,{style:{rotate:"180deg",color:"#F2B721"}})}),e("div",{className:"button",onClick:()=>q("right"),children:e(Le,{style:{color:"#3CDBA7"}})})]})]})]})}const Qe=t=>{let s=t.user;const[i,g]=h.useState(0),[E,I]=h.useState(0);return h.useEffect(()=>{I(Q(s.dob))},[s]),n("div",{className:"card",style:{backgroundImage:`url(${s.photos[i]})`},onClick:o=>{i<s.photos.length-1?g(i+1):g(0)},children:[s.photos.length>1&&e("div",{className:"image-count",children:s.photos.map((o,p)=>e("div",{className:`image ${p==i?"active":""}`,onClick:c=>{c.stopPropagation(),g(p)}}))}),n("div",{className:"card-content",children:[n("div",{className:"name",children:[s.name," ",e("span",{children:E})]}),e("div",{className:"description",children:s.bio})]})]})};function et(){const{LoggedIn:t,Account:s}=h.useContext(z),i=j(Y.PhoneNumber),[g,E]=s,[I,o]=t,[p,c]=h.useState("notLoggedIn"),[v,u]=h.useState(0),[l,f]=h.useState({});h.useEffect(()=>{de("Tinder")&&(p=="notLoggedIn"?Y.Styles.TextColor.set("#ffffff"):Y.Styles.TextColor.set("#000000"))},[p]);const[r,w]=h.useState({name:null,photos:[],_dob:{day:"",month:"",year:""},dob:null,bio:null,showMen:!1,showWomen:!1,isMale:null,active:!0}),T=d=>{var P,R,b;switch(d){case 0:let M=new Date(`${(P=r._dob)==null?void 0:P.year}/${(R=r._dob)==null?void 0:R.month}/${(b=r._dob)==null?void 0:b.day}`);if(y(M)){let a=Q(M);r.name&&r.name.length>=2&&a>=18&&a<=100&&(w({...r,dob:M.getTime()}),u(d+1))}break;case 1:r.photos.length>0&&u(d+1);break;case 2:r.bio&&r.bio.length>=10&&u(d+1);break;case 3:(r.showMen||r.showWomen)&&u(d+1);break;case 4:(r.isMale==!0||r.isMale==!1)&&L("Tinder",{action:"createAccount",data:{...r,dob:new Date(r.dob).toISOString().split("T")[0]}},!0).then(a=>{if(!a)return Z("error","Failed to create account");G.APPS.TINDER.account.set(r),E(r),o(!0)});break}},y=d=>d.getTime()===d.getTime();let A=[m("APPS.TINDER.CREATE_ACCOUNT"),m("APPS.TINDER.ADD_PHOTOS"),m("APPS.TINDER.DESCRIPTION"),m("APPS.TINDER.SHOW_ME"),m("APPS.TINDER.I_AM")];return e("div",{className:"login-container",style:{background:p==="notLoggedIn"?"linear-gradient(45deg, #ff4573, #ff5f65)":"#ffffff"},children:p==="notLoggedIn"?n(W,{children:[n("div",{className:"logo",children:[e("img",{src:"./assets/img/icons/tinder/logo-white.svg"}),e("div",{className:"logo-text",children:m("APPS.TINDER.TITLE").toLowerCase()})]}),n("div",{className:"buttons",children:[e("div",{className:"disclamer",children:m("APPS.TINDER.AGREE_TERMS")}),e("div",{className:"button create",onClick:()=>c("createAccount"),children:m("APPS.TINDER.CREATE_ACCOUNT")})]})]}):n("div",{className:"create-account",children:[n("div",{className:"login-header",children:[e(_e,{onClick:()=>{v>0?u(v-1):c("notLoggedIn")}}),e("div",{className:"title",children:A[v]})]}),v==0&&e(W,{children:n("div",{className:"form-body",children:[e(U,{defaultValue:Oe(i),type:"text",disabled:!0}),e(U,{placeholder:"Name",type:"text",maxLength:25,onChange:d=>{w({...r,name:d.target.value}),d.target.value.length>=3?f({...l,name:!0}):f({...l,name:!1})}}),n("div",{className:"dob",children:[n("div",{className:"inputs",children:[e(U,{placeholder:"MM",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:d=>{w({...r,_dob:{...r._dob,month:d.target.value}})}}),e("span",{children:"/"}),e(U,{placeholder:"DD",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:d=>{w({...r,_dob:{...r._dob,day:d.target.value}})}}),e("span",{children:"/"}),e(U,{placeholder:"YYYY",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:4,maxLength:4,onChange:d=>{var M,a,S;let P={...r,_dob:{...r._dob,year:d.target.value}};w(P);let R=new Date(`${(M=P._dob)==null?void 0:M.year}/${(a=P._dob)==null?void 0:a.month}/${(S=P._dob)==null?void 0:S.day}`),b=Q(R);b>=18&&b<100?f({...l,18:!0}):f({...l,18:!1})}})]}),e("div",{className:"disclamer",children:m("APPS.TINDER.AGE_PUBLIC")}),n("div",{className:"requirement",children:[l[18]?e(oe,{className:"green"}):e(re,{className:"red"}),m("APPS.TINDER.BE_OVER_18")]}),n("div",{className:"requirement",children:[l.name?e(oe,{className:"green"}):e(re,{className:"red"}),m("APPS.TINDER.NAME_MINIMUM")]})]})]})}),v==1&&n(W,{children:[e("div",{className:"photo-grid",children:[...Array(6)].map((d,P)=>{var b;let R=((b=r.photos)==null?void 0:b[P-1])||P==0;return r.photos[P]?e("div",{className:"photo",style:{backgroundImage:`url(${r.photos[P]})`},children:e("div",{className:"button remove",onClick:()=>{let M=r.photos;M.splice(P,1),w({...r,photos:M}),M.length==0&&f({...l,photos:!1})},children:e(ee,{})})}):e("div",{className:"photo",children:R&&e("div",{className:"button add",onClick:()=>{var M,a,S;B.Gallery.set({allowExternal:(S=(a=(M=ie)==null?void 0:M.value)==null?void 0:a.AllowExternal)==null?void 0:S.Spark,onSelect:D=>w({...r,photos:[...r.photos,D.src]})}),f({...l,photos:!0})},children:e(Te,{})})})})}),n("div",{className:"requirement",children:[l.photos?e(oe,{className:"green"}):e(re,{className:"red"}),m("APPS.TINDER.PHOTOS_MINIMUM")]})]}),v==2&&n(W,{children:[e(Ae,{placeholder:"Description",maxLength:200,onChange:d=>{w({...r,bio:d.target.value}),d.target.value.length>=10?f({...l,bio:!0}):f({...l,bio:!1})}}),n("div",{className:"requirement",children:[l.bio?e(oe,{className:"green"}):e(re,{className:"red"}),m("APPS.TINDER.DESCRIPTION_MINIMUM")]})]}),v==3&&e(W,{children:n("div",{className:"showme",children:[e("div",{className:`button border ${r.showWomen&&!r.showMen?"active":""}`,onClick:()=>{w({...r,showMen:!1,showWomen:!0})},children:m("APPS.TINDER.WOMEN")}),e("div",{className:`button border ${r.showMen&&!r.showWomen?"active":""}`,onClick:()=>{w({...r,showMen:!0,showWomen:!1})},children:m("APPS.TINDER.MEN")}),e("div",{className:`button border ${r.showMen&&r.showWomen?"active":""}`,onClick:()=>{w({...r,showMen:!0,showWomen:!0})},children:m("APPS.TINDER.EVERYONE")})]})}),v==4&&e(W,{children:n("div",{className:"showme",children:[e("div",{className:`button border ${r.isMale===!0?"active":""}`,onClick:()=>{w({...r,isMale:!0})},children:m("APPS.TINDER.MALE")}),e("div",{className:`button border ${r.isMale===!1?"active":""}`,onClick:()=>{w({...r,isMale:!1})},children:m("APPS.TINDER.FEMALE")})]})}),e("div",{className:"button gradient",onClick:()=>T(v),children:m("APPS.TINDER.CONTINUE")})]})})}const le=Ve(null);function tt(){var M;const{View:t,User:s}=h.useContext(z);j(Y.Settings);const i=j(Y.PhoneNumber),[g,E]=s,[I,o]=t,p=j(le),[c,v]=h.useState([]),[u,l]=h.useState(0),[f,r]=h.useState(!1),[w,T]=h.useState(!1),y=h.useRef(null),A=h.useRef(0),[d,P]=h.useState({content:"",attachments:[]});h.useEffect(()=>{de("Tinder")&&L("Tinder",{action:"getMessages",page:0,number:g.number},$.messages[g.number]).then(a=>{a&&a.length>0?v(a.reverse()):r(!0)})},[]);const R=()=>{if(d.content.length===0&&d.attachments.length===0)return;const a={sender:i,recipient:g.number,content:d.content,attachments:d.attachments,timestamp:new Date().getTime()};L("Tinder",{action:"sendMessage",data:a},!0).then(S=>{if(!S)return Z("error","Failed to send message");y.current.value="",P({content:"",attachments:[]}),v([...c,a])})},b=()=>{if(f||w)return;let a=document.querySelector("#last");if(!a)return;!We(a)&&(T(!0),L("Tinder",{action:"getMessages",page:u+1,number:g.number},null).then(D=>{if(D&&D.length>0){let V=document.querySelector(".message-container");A.current=V.scrollHeight,v([...D.reverse(),...c]),T(!1)}else r(!0)}),l(D=>D+1))};return h.useEffect(()=>{let a=document.querySelector(".message-container");const S=a.scrollHeight;a.scrollTop+=S-A.current,a.scroll},[c]),Me("tinder:newMessage",a=>{g.number===a.sender&&v([...c,a])}),n("div",{className:"home-wrapper slide left",children:[e(ye,{children:p&&e(st,{})}),n("div",{className:"message-header",children:[e(Fe,{onClick:()=>{o("messageList"),E(null)}}),n("div",{className:"user",onClick:()=>le.set(g),children:[e("img",{className:"profile-picture",src:(M=g.photos)==null?void 0:M[0]}),e("div",{className:"name",children:g.name})]})]}),e("div",{className:"message-container",onScroll:b,children:e("div",{className:"message-body",children:c.map((a,S)=>{var te,se,ne,q;let D,V=S===0?"last":"",H=a.sender===i?"self":"other",K=((te=c[S+1])==null?void 0:te.sender)===i?"self":"other";return c[S+1]?D=Math.abs(a.timestamp-c[S+1].timestamp)/36e5:K=void 0,n("div",{className:`message ${H}`,id:V,children:[H=="other"?n("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${H!==K?"show":"hide"}`,children:e("img",{src:(se=g.photos)==null?void 0:se[0]})}),n("div",{className:"message-content",children:[a.content&&e("div",{className:"content",children:be(a.content)}),((ne=a.attachments)==null?void 0:ne.length)>0&&e("div",{className:"attatchments",children:a.attachments.map((k,F)=>ue(k)?e("video",{src:k,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:N=>{B.FullscreenImage.set(k)}},F):e(Ue,{src:k,onClick:()=>{B.FullscreenImage.set(k)}},F))})]})]}):n(W,{children:[a.content&&e("div",{className:"content",children:be(a.content)}),((q=a.attachments)==null?void 0:q.length)>0&&e("div",{className:"attatchments",children:a.attachments.map((k,F)=>ue(k)?e("video",{src:k,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:()=>{B.FullscreenImage.set(k)}},F):e("img",{src:k,onClick:()=>{B.FullscreenImage.set(k)}},F))})]}),c[S+1]&&D>6?e("div",{className:"date",children:Ee(a.timestamp)}):H!==K&&e("div",{className:"date",children:Ee(a.timestamp)})]},S)})})}),e("div",{className:"attachments",children:d.attachments.map((a,S)=>n("div",{className:"attachment",children:[ue(a)?e("video",{src:a,controls:!1,muted:!0,loop:!0,autoPlay:!0}):e("img",{src:a}),e(ee,{onClick:()=>{P({...d,attachments:d.attachments.filter((D,V)=>V!==S)})}})]}))}),n("div",{className:"message-bottom",children:[e($e,{className:"image",onClick:()=>{var a,S,D;d.attachments.length<3&&B.Gallery.set({includeVideos:!0,allowExternal:(D=(S=(a=ie)==null?void 0:a.value)==null?void 0:S.AllowExternal)==null?void 0:D.Messages,onSelect:V=>P({...d,attachments:[...d.attachments,V.src]})})}}),n("div",{className:"input",children:[e(U,{type:"text",placeholder:"Type a message...",ref:y,onChange:a=>{P({...d,content:a.target.value})},onKeyDown:a=>{a.key==="Enter"&&R()}}),e(He,{className:d.attachments.length>0||d.content.length>0?"active":"",onClick:()=>R()})]})]})]})}const st=()=>{const t=j(le),[s,i]=h.useState(0);return t?n(Se.div,{initial:{opacity:0,y:500},animate:{opacity:1,y:0},exit:{opacity:0,y:500},className:"popup-profile-container",children:[n("div",{className:"gallery",children:[e("img",{src:t==null?void 0:t.photos[s],onClick:()=>{t&&i(s<(t==null?void 0:t.photos.length)-1?s+1:0)}}),(t==null?void 0:t.photos.length)>1&&e("div",{className:"image-count",children:t==null?void 0:t.photos.map((g,E)=>e("div",{className:Be("image",E==s&&"active"),onClick:I=>{I.stopPropagation(),i(E)}}))}),e("div",{className:"close",onClick:()=>le.set(null),children:e(ee,{})})]}),n("div",{className:"card-content",children:[n("div",{className:"name",children:[t==null?void 0:t.name,", ",e("span",{children:Q(t==null?void 0:t.dob)})]}),e("div",{className:"divider"}),n("div",{className:"description",children:[e("div",{className:"title",children:"About Me"}),t==null?void 0:t.bio]})]})]}):null};function nt(){const{View:t,User:s}=h.useContext(z),[i,g]=s,[E,I]=t,[o,p]=h.useState({newMatches:[],messages:[]});return h.useEffect(()=>{de("Tinder")&&(Y.Styles.TextColor.set("#000000"),L("Tinder",{action:"getMatches"},{newMatches:$.accounts.filter(c=>c.matched&&!$.messages[c.number]),messages:$.accounts.filter(c=>$.messages[c.number])}).then(c=>{if(!c)return Z("warning","No response received from Tinder getMatches");p(c)}))},[]),Me("tinder:newMessage",c=>{let v=c.sender,u=JSON.parse(JSON.stringify(o)),l=u.messages.findIndex(f=>f.number===v);if(l!==-1)u.messages.unshift(u.messages.splice(l,1)[0]);else if(l=u.newMatches.findIndex(f=>f.number===v),l!==-1)u.messages.unshift(u.newMatches.splice(l,1)[0]);else return;u.messages[0].lastMessage=c.content,p(u)}),n("div",{className:"home-wrapper slide left",children:[e(Ne,{}),e(Ge,{placeholder:m("APPS.TINDER.SEARCH_MATCHES"),onChange:()=>{}})," ",n("div",{className:"message-list-body",children:[n("div",{className:"new-matches",children:[n("div",{className:"title",children:[m("APPS.TINDER.NEW_MATCHES"),o.newMatches.length>0&&e("span",{children:o.newMatches.length})]}),e("div",{className:"matches",children:o.newMatches.map((c,v)=>{var u;return n("div",{className:"new-match",onClick:()=>{g(c),I("message")},children:[e("img",{className:"profile-picture",src:(u=c.photos)==null?void 0:u[0]}),e("div",{className:"name",children:c.name})]},v)})})]}),n("div",{className:"recent-messages",children:[e("div",{className:"title",children:m("APPS.TINDER.MESSAGES")}),e("div",{className:"messages",children:o.messages.map((c,v)=>{var u,l;return((u=c.lastMessage)==null?void 0:u.length)===0&&(c.lastMessage=m("APPS.MESSAGES.SENT_A_PHOTO")),n("div",{className:"message",onClick:()=>{g(c),I("message")},children:[e("img",{className:"profile-picture",src:(l=c.photos)==null?void 0:l[0]}),n("div",{className:"user",children:[e("div",{className:"name",children:c.name}),e("div",{className:"message",children:c.lastMessage.length>40?c.lastMessage.substring(0,40)+"...":c.lastMessage})]})]},v)})})]})]})]})}function at(){var c,v;const{Account:t,LoggedIn:s}=h.useContext(z),[i,g]=s,[E,I]=t,[o,p]=h.useState(E);return n("div",{className:"home-wrapper slide right",style:{backgroundColor:"#F6F6F6"},children:[e(Ne,{}),n("div",{className:"profile-body",children:[n("div",{className:"user",children:[e("img",{className:"profile-picture",src:o.photos[0]}),n("div",{className:"name",children:[o.name,", ",Q(o.dob)]})]}),n("div",{className:"inputs",children:[n("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.NAME")}),e(U,{type:"text",defaultValue:o.name,maxLength:10,onChange:u=>{p({...o,name:u.target.value})}})]}),n("div",{className:"input center",children:[e("div",{className:"label",children:m("APPS.TINDER.PHOTOS")}),e("div",{className:"photo-grid",children:[...Array(6)].map((u,l)=>{var r;let f=((r=o.photos)==null?void 0:r[l-1])||l==0;return o.photos[l]?e("div",{className:"photo",style:{backgroundImage:`url(${o.photos[l]})`},children:e("div",{className:"photo-button remove",onClick:()=>{let w=o.photos;w.splice(l,1),p({...o,photos:w})},children:e(ee,{})})},l):e("div",{className:"photo",children:f&&e("div",{className:"photo-button add",onClick:()=>{var w,T,y;B.Gallery.set({allowExternal:(y=(T=(w=ie)==null?void 0:w.value)==null?void 0:T.AllowExternal)==null?void 0:y.Spark,onSelect:A=>p({...o,photos:[...o.photos,A.src]})})},children:e(Te,{})})})})})]}),n("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.ABOUT_ME")}),e(Ae,{type:"text",defaultValue:o.bio,maxLength:100,onChange:u=>{p({...o,bio:u.target.value})}})]}),n("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.INTERESTED_IN")}),n("select",{value:o.showMen&&o.showWomen?"Everyone":o.showMen?"Men":"Women",onChange:u=>{switch(u.target.value){case"Everyone":p({...o,showMen:!0,showWomen:!0});break;case"Men":p({...o,showMen:!0,showWomen:!1});break;case"Women":p({...o,showMen:!1,showWomen:!0});break}},children:[e("option",{value:"Men",children:m("APPS.TINDER.MEN")}),e("option",{value:"Women",children:m("APPS.TINDER.WOMEN")}),e("option",{value:"Everyone",children:m("APPS.TINDER.EVERYONE")})]})]}),n("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.GENDER")}),n("select",{value:o.isMale?"male":"female",onChange:u=>{u.target.value=="male"?p({...o,isMale:!0}):p({...o,isMale:!1})},children:[e("option",{value:"male",children:m("APPS.TINDER.MALE")}),e("option",{value:"female",children:m("APPS.TINDER.FEMALE")})]})]}),n("div",{className:"input",children:[e("div",{className:"label",children:m("APPS.TINDER.VISIBILITY")}),n("select",{value:o.active?"visible":"hidden",onChange:u=>{let l=u.target.value;p({...o,active:l==="visible"})},children:[e("option",{value:"visible",children:m("APPS.TINDER.VISIBLE")}),e("option",{value:"hidden",children:m("APPS.TINDER.HIDDEN")})]}),!o.active&&e("div",{className:"warning",children:m("APPS.TINDER.HIDDEN_WARNING")})]})]}),((v=(c=ie)==null?void 0:c.value)==null?void 0:v.DeleteAccount.Spark)&&e("div",{className:"button red",onClick:()=>{Ye("Tinder",()=>{I(null),g(!1)},!0)},children:m("APPS.TINDER.DELETE_ACCOUNT")}),e("div",{className:"button gradient",onClick:()=>{o.name.length>=2&&o.bio.length>=5&&o.photos.length>=1?L("Tinder",{action:"saveProfile",data:o},!0).then(u=>{if(!u)return Z("error","Issue saving tinder profile");G.APPS.TINDER.account.set(o),I(o)}):Z("error","Issue saving tinder profile, (name not 2 characters, bio not over 5 or no photos)")},children:m("APPS.TINDER.SAVE")})]})]})}const z=h.createContext(null);function it(){const t=j(Y.Settings),[s,i]=h.useState(!1),[g,E]=h.useState(null),[I,o]=h.useState(null),[p,c]=h.useState("home"),[v,u]=h.useState(!0),l={home:e(Ze,{}),profile:e(at,{}),messageList:e(nt,{}),message:e(tt,{})};return h.useEffect(()=>{if(G.APPS.TINDER.account.value){E(G.APPS.TINDER.account.value),i(!0),u(!1);return}else if(G.APPS.TINDER.account.value===!1)return u(!1);L("Tinder",{action:"isLoggedIn"},$.account).then(f=>{f?(E(f),i(!0),G.APPS.TINDER.account.set(f)):G.APPS.TINDER.account.set(!1),u(!1)})},[]),h.useEffect(()=>(p==="message"?he.ReceiveAppNotifications.set(!1):he.ReceiveAppNotifications.set(!0),()=>{he.ReceiveAppNotifications.set(!0)}),[p]),e("div",{className:"tinder-container",children:e(z.Provider,{value:{LoggedIn:[s,i],Account:[g,E],User:[I,o],View:[p,c]},children:v||t!=null&&t.airplaneMode?e("div",{className:"loading",children:e(ze,{size:40,lineWeight:5,speed:2,color:"#000000"})}):s?l[p]:e(et,{})})})}function Q(t){var s=+new Date(t);return~~((Date.now()-s)/315576e5)}export{z as TinderContext,it as default,Q as getAge};
