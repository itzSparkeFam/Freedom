const _0x54f437=_0x19a0;!function(){for(var n=_0x19a0,e=_0x215d();;)try{if(211789==+parseInt(n(225))*(-parseInt(n(279))/2)+parseInt(n(327))/3+parseInt(n(347))/4*(parseInt(n(343))/5)+-parseInt(n(314))/6*(parseInt(n(313))/7)+-parseInt(n(159))/8*(parseInt(n(351))/9)+parseInt(n(201))/10+-parseInt(n(319))/11*(-parseInt(n(196))/12))break;e.push(e.shift())}catch(n){e.push(e.shift())}}();import{Post,getOwnedObjects}from"./api.js";import*as _0x5aedeb from"three";import{TransformControls}from"three/addons/controls/TransformControls.js";let decorateMenu=null,editable=!1,editingData={};function setDecorateMenu(n){decorateMenu=n}const tracking={x:0,y:0},objectInfos={},furniData={prevY:[],prevX:[],prevZ:[],prevPitch:[],prevRoll:[],prevYaw:[]};let isTransforming=!1,editingId=null;const degToRad=n=>{var e=_0x19a0,t={PaFeB:function(n,e){return n*e},nIkGq:function(n,e){return n/e}};return t[e(199)](n,t[e(163)](Math.PI,180))},radToDeg=n=>{var e=_0x19a0,t={RsKBk:function(n,e){return n*e},dyqqe:function(n,e){return n/e}};return t[e(346)](n,t[e(317)](180,Math.PI))},selectLegacyObject=async n=>{var e=_0x19a0,t={jRRza:function(n,e){return n!=e},ErfqB:function(n,e){return n==e},DbhxO:function(n){return n()},CsItS:function(n,e){return n==e},YfaEg:function(n,e){return n<e},RgvBj:function(n,e){return n==e}};if(t[e(208)](decorateMenu,null)&&t[e(182)](decorateMenu[e(250)],2)){var r=await t[e(265)](getOwnedObjects);if(!t[e(258)](r[decorateMenu[e(302)][e(331)+"u"][e(297)]][e(326)],n)){for(var a=null,o=0;t[e(337)](o,r[e(280)]);o++)if(t[e(282)](r[o][e(326)],n)){a=o;break}t[e(208)](a,null)&&(decorateMenu[e(302)][e(331)+"u"][e(297)]=a),decorateMenu[e(302)][e(331)+"u"][e(250)]()}}},mouseDownHandler=async n=>{var e=_0x19a0,t={IXTDk:function(n,e){return n&&e},ROwUw:function(n,e){return n!==e},aCsEG:e(334),MfTcK:function(n,e,t){return n(e,t)},KaxUQ:e(235)+e(361),QEyBp:function(n,e){return n!==e},OCuoe:function(n,e){return n!=e},OZbEl:function(n,e){return n==e},JZjvn:function(n){return n()},KGqac:function(n,e){return n<e},vwwlU:function(n,e){return n==e},WjNVv:function(n,e){return n!=e},bDviO:function(n,e){return n(e)},ZLfJL:e(220)};if(!(isTransforming=!t[e(273)](isTransforming,!editingId)&&isTransforming)&&!t[e(342)](n[e(276)][e(175)],t[e(335)])){var n=tracking.x,r=tracking.y,a=await t[e(315)](Post,t[e(206)],{x:n,y:r});if(a[e(188)]&&t[e(274)](editingId,a[e(161)]))if(t[e(333)](decorateMenu,null)&&t[e(245)](decorateMenu[e(250)],2)){var o=await t[e(290)](getOwnedObjects);if(!t[e(245)](o[decorateMenu[e(302)][e(331)+"u"][e(297)]][e(326)],a[e(161)])){for(var i=null,c=0;t[e(309)](c,o[e(280)]);c++)if(t[e(190)](o[c][e(326)],a[e(161)])){i=c;break}t[e(295)](i,null)&&(decorateMenu[e(302)][e(331)+"u"][e(297)]=i),decorateMenu[e(302)][e(331)+"u"][e(250)]()}}else t[e(290)](clearData),editingId=a[e(161)],t[e(181)](changeEntity,editingId),isTransforming=!1;else if(!a[e(188)]){var s=t[e(254)][e(162)]("|");let n=0;for(;;){switch(s[n++]){case"0":t[e(290)](clearData);continue;case"1":transformControls[e(244)]=!1;continue;case"2":if(t[e(295)](decorateMenu,null)&&t[e(245)](decorateMenu[e(250)],2))return;continue;case"3":isTransforming=!1;continue;case"4":editingId=null;continue}break}}}},handleTracking=(window[_0x54f437(323)+_0x54f437(226)](_0x54f437(242),mouseDownHandler),n=>{var e=_0x54f437,t={vZFSX:function(n,e){return n-e},DkRvn:function(n,e){return n-e},rWbLG:function(n,e,t){return n(e,t)},qwEaV:function(n,e,t){return n(e,t)}},r=t[e(251)](n[e(221)],n[e(276)][e(310)]),n=t[e(350)](n[e(283)],n[e(276)][e(310)]);tracking.x=t[e(219)](normalize,r,document[e(197)+e(371)][e(301)+"h"]),tracking.y=t[e(173)](normalize,n,document[e(197)+e(371)][e(239)+"ht"])}),Scene=new _0x5aedeb[_0x54f437(284)],Renderer=new _0x5aedeb[_0x54f437(285)+_0x54f437(354)]({alpha:!0}),Camera=(Renderer[_0x54f437(264)](window[_0x54f437(364)],window[_0x54f437(352)+"t"]),document[_0x54f437(299)+_0x54f437(359)](_0x54f437(171))[_0x54f437(169)+"d"](Renderer[_0x54f437(296)]),new _0x5aedeb[_0x54f437(223)+_0x54f437(263)](50,window[_0x54f437(364)]/window[_0x54f437(352)+"t"],.1,1e4)),boxGeometry=(Camera[_0x54f437(214)][_0x54f437(275)]=_0x54f437(228),new _0x5aedeb[_0x54f437(212)+"y"](1,1,1)),meshPhongMaterial=new _0x5aedeb[_0x54f437(241)+_0x54f437(272)]({color:16711935,transparent:!0,opacity:0}),Mesh=new _0x5aedeb[_0x54f437(252)](boxGeometry,meshPhongMaterial);Mesh[_0x54f437(214)][_0x54f437(275)]=_0x54f437(228),Mesh[_0x54f437(177)][_0x54f437(325)](1,1,1),Scene[_0x54f437(204)](Mesh),Renderer[_0x54f437(296)][_0x54f437(191)][_0x54f437(308)]=_0x54f437(247);let animationFrameActive=null;function renderGeometry(){var n=_0x54f437;animationFrameActive={KkNwn:function(n,e){return n(e)}}[n(298)](requestAnimationFrame,renderGeometry),Renderer[n(234)](Scene,Camera)}function showGeometry(){var n=_0x54f437,e={MpNDa:n(186)};transformControls[n(244)]=!1,Renderer[n(296)][n(191)][n(308)]=e[n(231)]}function hideGeometry(){var n=_0x54f437,e={PreXz:n(247)};transformControls[n(244)]=!1,Renderer[n(296)][n(191)][n(308)]=e[n(336)]}function hideTransformControls(){var n=_0x54f437;transformControls[n(244)]=!1}const transformControls=new TransformControls(Camera,Renderer[_0x54f437(296)]);function _0x19a0(n,e){const t=_0x215d();return(_0x19a0=function(n,e){return n-=159,t[n]})(n,e)}transformControls[_0x54f437(323)+_0x54f437(226)](_0x54f437(316),()=>{var n=_0x54f437,e={xCszb:function(n,e){return n(e)},ygRmk:function(n){return n()}},t=objectInfos[editingId];Mesh[n(292)].x&&Mesh[n(292)].y&&Mesh[n(292)].z&&t&&(t.x=Mesh[n(292)].x,t.y=-Mesh[n(292)].z,t.z=Mesh[n(292)].y,t[n(218)]=e[n(363)](radToDeg,Mesh[n(214)].x),t[n(370)]=e[n(363)](radToDeg,-Mesh[n(214)].z),t[n(262)]=e[n(363)](radToDeg,Mesh[n(214)].y),e[n(340)](editEntity),Renderer[n(234)](Scene,Camera))});const editEntity=()=>{var n=_0x54f437,e={sqBug:function(n,e,t){return n(e,t)},bpNfr:n(366)+"y",yFeKz:function(n,e){return n(e)},KBQsz:function(n,e){return n(e)},TlNsF:function(n,e){return n(e)},MBGZP:function(n,e){return n(e)},yttlY:function(n,e){return n(e)}},t=objectInfos[editingId];e[n(248)](Post,e[n(311)],{id:editingId,alpha:e[n(233)](parseInt,t[n(174)]),x:e[n(269)](parseFloat,t.x),y:e[n(269)](parseFloat,t.y),z:e[n(193)](parseFloat,t.z),pitch:e[n(233)](parseFloat,t[n(218)]),roll:e[n(217)](parseFloat,t[n(370)]),yaw:e[n(217)](parseFloat,t[n(262)])}),e[n(338)](setObjectHelperValues,t)},storeData=(transformControls[_0x54f437(323)+_0x54f437(226)](_0x54f437(202),()=>{var n=_0x54f437;isTransforming=!0,{xRVKo:function(n){return n()}}[n(286)](storeData)}),transformControls[_0x54f437(323)+_0x54f437(226)](_0x54f437(237),()=>{var n=_0x54f437,e=objectInfos[editingId];e&&(e.x=Mesh[n(292)].x,e.y=-Mesh[n(292)].z,e.z=Mesh[n(292)].y,isTransforming=!1)}),transformControls[_0x54f437(165)+_0x54f437(358)](.1),transformControls[_0x54f437(264)](.8),transformControls[_0x54f437(345)+_0x54f437(278)](degToRad(15)),transformControls[_0x54f437(293)](Mesh),Scene[_0x54f437(204)](transformControls),()=>{var e=_0x54f437,t={TbUKh:function(n,e){return n!==e},wWzLk:e(207)+"1"},r=objectInfos[editingId];if(r&&t[e(307)](r.x,0)&&t[e(307)](r.y,0)&&t[e(307)](r.z,0)){var a=t[e(224)][e(162)]("|");let n=0;for(;;){switch(a[n++]){case"0":furniData[e(187)][e(180)](r.x);continue;case"1":furniData[e(321)][e(180)](r[e(262)]);continue;case"2":furniData[e(271)][e(180)](r.y);continue;case"3":furniData[e(277)][e(180)](r.z);continue;case"4":furniData[e(291)][e(180)](r[e(370)]);continue;case"5":furniData[e(330)][e(180)](r[e(218)]);continue}break}}});function cancelRenderGeometry(){var n=_0x54f437;animationFrameActive&&({tEwQv:function(n,e){return n(e)}}[n(287)](cancelAnimationFrame,animationFrameActive),animationFrameActive=null)}function _0x215d(){const n=["key","DSjpw","OJixX","appendChil","val","#decorate","1|9|3|8|4|","qwEaV","alpha","tagName","vhLGm","scale","mousemove","PWYmv","push","bDviO","ErfqB","pDaoT","wWnFy","QeRoy","block","prevX","hit","fov","vwwlU","style","|12|6|7","TlNsF","rMtRs","toggleCurs","396CbdNXu","documentEl","3|1|6|4|2|","PaFeB","ty-roll","2036220JcUFEH","mouseDown","cam","add","rbAcE","KaxUQ","0|2|3|5|4|","jRRza","lwGJT","vbiXg","ty-y","BoxGeometr","oOOTq","rotation","USiAR","lper #enti","MBGZP","pitch","rWbLG","2|0|4|1|3","pageX","ect","Perspectiv","wWzLk","370489SqtCCD","stener","wwJhq","YZX","aiXmr","aAkGH","MpNDa","KiQdg","yFeKz","render","select_ent","0|5","mouseUp","saojV","scrollHeig","apohN","MeshPhongM","mousedown","updateProj","visible","OZbEl","uCoRO","none","sqBug","puXYz","sort","vZFSX","Mesh","toggleMous","ZLfJL","5|14|2|10|","lSJUo","HOWmR","CsItS","mpymo","ty-yaw","WlPcB","yaw","eCamera","setSize","DbhxO","3|4|5|2|0|","lwPiQ","abtpy","KBQsz","hash","prevY","aterial","IXTDk","QEyBp","order","target","prevZ","nSnap","2lTiyZO","length","aRLJh","RgvBj","pageY","Scene","WebGLRende","xRVKo","tEwQv","y_info","LnVjc","JZjvn","prevRoll","position","attach","qUqNn","WjNVv","domElement","stash","KkNwn","querySelec","l-name","scrollWidt","categories","ty-x","TMmkC","Grjtn","czcIi","TbUKh","display","KGqac","offsetTop","bpNfr","gndQy","27069CvsvLF","162iTVItG","MfTcK","change","dyqqe","ty-z","75559HUOTLT","Mwzru","prevYaw","iRmVH","addEventLi","ypwwS","set","handle","303642lzZmgO","yKbKP","setMode","prevPitch","sortingMen","AhyxL","OCuoe","CANVAS","aCsEG","PreXz","YfaEg","yttlY","load_entit","ygRmk","ty-pitch","ROwUw","11805YKXoyc","HevxN","setRotatio","RsKBk","648WCKlDS","11|0|15|13","eMovement","DkRvn","36ruHZnW","innerHeigh","ajbuO","rer","exists","rotate","ectionMatr","tionSnap","tor","keydown","ity","distance","xCszb","innerWidth","translate","edit_entit","VeWEL","ground_obj","CeaqQ","roll","ement","JxIra","454616igHeZf","#object-he","entity","split","nIkGq","lper #mode","setTransla"];return(_0x215d=function(){return n})()}function setEditMode(n){var e=_0x54f437,t={ajbuO:function(n,e){return n===e},CeaqQ:e(356),yKbKP:e(365)};t[e(353)](n,t[e(369)])?transformControls[e(329)](t[e(369)]):transformControls[e(329)](t[e(328)])}function setRotationSnap(n){var e=_0x54f437;transformControls[e(345)+e(278)](n)}function setTranslationSnap(n){var e=_0x54f437;transformControls[e(165)+e(358)](n)}const normalize=(n,e)=>{var t=_0x54f437,r={AhyxL:function(n,e){return n+e},vbiXg:function(n,e){return n/e},LnVjc:function(n,e){return n*e},abtpy:function(n,e){return n-e}};return r[t(332)](r[t(210)](r[t(289)](1,r[t(268)](n,0)),r[t(268)](e,0)),0)},handleUpdatePositions=(window[_0x54f437(323)+_0x54f437(226)](_0x54f437(178),handleTracking),n=>{var e=_0x54f437,t={lwPiQ:function(n,e){return n(e)},saojV:function(n,e){return n(e)},mpymo:function(n,e,t){return n(e,t)},VeWEL:function(n,e){return n(e)},czcIi:function(n,e){return n(e)}},r=(Camera[e(292)][e(325)](n[e(203)][e(292)].x,n[e(203)][e(292)].z,-n[e(203)][e(292)].y),n[e(203)][e(214)].x),a=n[e(203)][e(214)].z,o=n[e(203)][e(214)].y;Camera[e(214)][e(325)](t[e(267)](degToRad,r),t[e(238)](degToRad,t[e(259)](zRotationHandler,r,a)),t[e(367)](degToRad,o)),Camera[e(189)]=n[e(203)][e(189)],Camera[e(243)+e(357)+"ix"](),n[e(161)][e(292)]&&(Mesh[e(292)][e(325)](n[e(161)][e(292)].x,n[e(161)][e(292)].z,-n[e(161)][e(292)].y),Mesh[e(214)][e(325)](t[e(367)](degToRad,n[e(161)][e(214)].x),t[e(306)](degToRad,n[e(161)][e(214)].z),t[e(306)](degToRad,-n[e(161)][e(214)].y)))}),changeEntity=async n=>{var e=_0x54f437,t={lwGJT:function(n,e,t){return n(e,t)},puXYz:e(339)+e(288),HevxN:function(n,e){return n(e)}},n=await t[e(209)](Post,t[e(249)],{id:t[e(344)](parseInt,n)});t[e(344)](setEntityData,n)},zRotationHandler=(n,e)=>{var t=_0x54f437,r={aRLJh:function(n,e){return e<n},vhLGm:function(n,e){return n<e},aiXmr:function(n,e){return n<e}};return(!r[t(281)](n,0)||!r[t(176)](n,90))&&(r[t(281)](n,-180)&&r[t(229)](n,-90)||r[t(281)](n,0))?-e:e},setEntityData=n=>{var e=_0x54f437,t={wwJhq:e(255)+e(172)+e(348)+e(192),apohN:function(n,e){return n(e)},KiQdg:function(n,e){return n!==e},QeRoy:function(n){return n()}},r=t[e(227)][e(162)]("|");let a=0;for(;;){switch(r[a++]){case"0":editingData[e(218)]=n[e(218)];continue;case"1":objectInfos[editingId]={id:n.id,hash:n[e(270)],alpha:n[e(174)],x:n.x,y:n.y,z:n.z,pitch:n[e(218)],roll:n[e(370)],yaw:n[e(262)],distance:n[e(362)],quaternion:{}};continue;case"2":editable=!0;continue;case"3":editingData[e(174)]=n[e(174)];continue;case"4":editingData.y=n.y;continue;case"5":if(n[e(355)])continue;return editable=!1,void(transformControls[e(244)]=!1);case"6":transformControls[e(244)]=!0;continue;case"7":t[e(240)](setObjectHelperValues,n);continue;case"8":editingData.x=n.x;continue;case"9":editingData[e(270)]=n[e(270)];continue;case"10":editingId=n.id;continue;case"11":editingData.z=n.z;continue;case"12":editingData[e(362)]=n[e(362)];continue;case"13":editingData[e(262)]=n[e(262)];continue;case"14":t[e(232)](editingId,n.id)&&t[e(185)](clearData);continue;case"15":editingData[e(370)]=n[e(370)];continue}break}},setObjectHelperValues=n=>{var e=_0x54f437,t={rbAcE:e(198)+e(236),lSJUo:function(n,e){return n(e)},aAkGH:e(160)+e(216)+e(200),oOOTq:function(n,e){return n(e)},uCoRO:e(160)+e(216)+e(303),USiAR:function(n,e){return n(e)},HOWmR:e(160)+e(216)+e(341),rMtRs:e(160)+e(164)+e(300),DSjpw:e(160)+e(216)+e(318),WlPcB:e(160)+e(216)+e(260),JxIra:function(n,e){return n(e)},Grjtn:e(160)+e(216)+e(211)},r=t[e(205)][e(162)]("|");let a=0;for(;;){switch(r[a++]){case"0":t[e(256)]($,t[e(230)])[e(170)](n[e(370)]);continue;case"1":t[e(213)]($,t[e(246)])[e(170)](n.x);continue;case"2":t[e(215)]($,t[e(257)])[e(170)](n[e(218)]);continue;case"3":t[e(213)]($,t[e(194)])[e(170)](n[e(270)]);continue;case"4":t[e(256)]($,t[e(167)])[e(170)](n.z);continue;case"5":t[e(213)]($,t[e(261)])[e(170)](n[e(262)]);continue;case"6":t[e(372)]($,t[e(305)])[e(170)](n.y);continue}break}},clearData=()=>{var n=_0x54f437,e={PWYmv:n(266)+"1"}[n(179)][n(162)]("|");let t=0;for(;;){switch(e[t++]){case"0":furniData[n(291)]=[];continue;case"1":furniData[n(321)]=[];continue;case"2":furniData[n(330)]=[];continue;case"3":furniData[n(271)]=[];continue;case"4":furniData[n(187)]=[];continue;case"5":furniData[n(277)]=[];continue}break}};window[_0x54f437(323)+_0x54f437(226)](_0x54f437(360),async n=>{var e=_0x54f437,t={Mwzru:function(n,e){return n===e},TMmkC:function(n,e){return n(e)},OJixX:e(253)+e(349),pDaoT:function(n,e){return n(e)},qUqNn:e(195)+"or",iRmVH:function(n,e,t){return n(e,t)},wWnFy:e(368)+e(222),gndQy:function(n,e){return n(e)},ypwwS:function(n,e){return n(e)}};t[e(320)](n[e(166)],"F6")&&t[e(304)](Post,t[e(168)]),t[e(320)](n[e(166)],"F5")&&t[e(183)](Post,t[e(294)]),(t[e(320)](n[e(166)],"G")||t[e(320)](n[e(166)],"g"))&&(n=await t[e(322)](Post,t[e(184)],{id:t[e(312)](parseInt,editingId)}),t[e(324)](setEntityData,n))});export{setDecorateMenu,selectLegacyObject,renderGeometry,showGeometry,hideGeometry,hideTransformControls,cancelRenderGeometry,setEditMode,setRotationSnap,setTranslationSnap,handleUpdatePositions,changeEntity};